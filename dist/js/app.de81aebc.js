(function(){"use strict";var e={4213:function(e,t,r){var n=r(9242),o=r(3396);const a={class:"max-w-[1200px] mx-auto"};function l(e,t,r,l,s,i){const c=(0,o.up)("Navbar"),d=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(c),(0,o._)("div",a,[(0,o.Wm)(d,null,{default:(0,o.w5)((({Component:e,route:t})=>[(0,o.Wm)(n.uT,{name:"route",mode:"out-in"},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.iD)("div",{key:t.name},[((0,o.wg)(),(0,o.j4)((0,o.LL)(e)))]))])),_:2},1024)])),_:1})])],64)}const s={class:"bg-zinc-300 mb-6"},i={ref:"nav",class:"max-w-[1200px] mx-auto p-2 sm:px-2 md:px-10 lg:p-4 lg:px-6 flex flex-col sm:flex-row items-center justify-between gap-2"},c={class:"flex items-center gap-3"},d=(0,o.uE)('<svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"></rect><path d="M176,80h42.6a7.9,7.9,0,0,1,7.4,5l14,35" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="24"></path><line x1="16" y1="144" x2="176" y2="144" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="24"></line><circle cx="180" cy="192" r="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="24"></circle><circle cx="76" cy="192" r="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="24"></circle><line x1="156" y1="192" x2="100" y2="192" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="24"></line><path d="M52,192H24a8,8,0,0,1-8-8V72a8,8,0,0,1,8-8H176V168.3" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="24"></path><path d="M176,120h64v64a8,8,0,0,1-8,8H204" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="24"></path></svg>',1),u={key:1,class:"flex gap-4"};function p(e,t,r,n,a,l){const p=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",s,[(0,o._)("nav",i,[(0,o._)("div",c,[d,(0,o.Wm)(p,{class:"font-serif font-bold",to:{name:"Home"}},{default:(0,o.w5)((()=>[(0,o.Uk)("NouName")])),_:1})]),(0,o._)("div",null,[n.user?((0,o.wg)(),(0,o.iD)("div",{key:n.user,class:"flex gap-2 sm:gap-4 items-center justify-between sm:justify-end w-full text-xs sm:text-sm md:text-base"},[(0,o.Wm)(p,{class:"active:scale-95 active:tranzinc-y-[2px] transition-transform hover:shadow-inner",to:{name:"AddProduct"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Создать товар")])),_:1}),(0,o.Wm)(p,{class:"sm:text active:scale-95 active:tranzinc-y-[2px] transition-transform hover:shadow-inner",to:{name:"MyProducts"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Мои фрукты")])),_:1}),(0,o._)("button",{class:"md:text-base",onClick:t[0]||(t[0]=(...e)=>n.unAuth&&n.unAuth(...e))},"Выйти")])):((0,o.wg)(),(0,o.iD)("div",u,[(0,o.Wm)(p,{class:"btn",to:{name:"Signup"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Регистрация")])),_:1}),(0,o.Wm)(p,{class:"btn",to:{name:"Login"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Войти")])),_:1})]))])],512)])}r(7658);var m=r(4870),f=r(4275);r(7618),r(4059),r(4742);const v={apiKey:"AIzaSyDf9wg7hel8FkrX9nRpAo72Z0XmOOq2vLY",authDomain:"e-commerce-pet.firebaseapp.com",projectId:"e-commerce-pet",storageBucket:"e-commerce-pet.appspot.com",messagingSenderId:"601231647655",appId:"1:601231647655:web:118b8cf7fae5cb9e874c82",measurementId:"G-8Y7N6PQ6WW"};f.Z.initializeApp(v);const g=f.Z.firestore(),x=f.Z.auth(),w=f.Z.storage(),h=f.Z.firestore.FieldValue.serverTimestamp,b=(0,m.iH)(null),y=(0,m.iH)(!1),k=async()=>{b.value=null,y.value=!0;try{await x.signOut(),y.value=!1}catch(e){b.value=`Ошибка: ${e.message}`,y.value=!1}},_=()=>({error:b,logout:k,isPending:y});var z=_,D=r(2483);const P=(0,m.iH)(x.currentUser);x.onAuthStateChanged((e=>{console.log("текущий пользователь:",e),P.value=e}));const H=()=>({user:P});var U=H,C={name:"Navbar",setup(){const e=(0,D.tv)(),{error:t,logout:r,isPending:n}=z(),{user:o}=U(),a=async()=>{await r(),e.push({name:"Login"})};return{error:t,user:o,unAuth:a}}},j=r(89);const q=(0,j.Z)(C,[["render",p]]);var E=q,W={name:"App",components:{Navbar:E}};const I=(0,j.Z)(W,[["render",l]]);var S=I;function Z(e,t,r,n,a,l){const s=(0,o.up)("Products");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(s,{products:n.products},null,8,["products"])])}const A={class:"px-4"},N={class:"mb-5 flex flex-col gap-2 items-start"},V=(0,o._)("h2",{class:"self-start text-4xl font-medium"},[(0,o.Uk)(" Добро пожаловать на рынок "),(0,o._)("span",{class:"font-serif font-medium text-zinc-700"},"NouName")],-1),O=(0,o._)("h3",null,"Лучший онлайн рынок фруктов в СНГ",-1),F={key:0,class:"text-sm text-orange-400 font-serif font-bold"},M={class:"flex flex-col md:flex-row gap-4 items-start"},L=(0,o._)("label",{for:"search",class:"text-sm font-semibold"},"Поиск фруктов:",-1),T={key:0,class:"flex flex-col gap-2"},Y=(0,o._)("div",{class:""},"По вашему запросу ничего не найдено... ",-1);function $(e,t,r,a,l,s){const i=(0,o.up)("router-link"),c=(0,o.up)("Product");return(0,o.wg)(),(0,o.iD)("div",A,[(0,o._)("div",N,[V,O,a.user?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("h4",F,[(0,o.Uk)("Пожалуйста, "),(0,o.Wm)(i,{to:{name:"Login"},class:"font-bold border-b border-orange-500"},{default:(0,o.w5)((()=>[(0,o.Uk)("войдите")])),_:1}),(0,o.Uk)(" что бы добавить свои фрукты!")]))]),(0,o._)("div",M,[L,(0,o.wy)((0,o._)("input",{id:"search",onInput:t[0]||(t[0]=(...e)=>a.computedProduct&&a.computedProduct(...e)),type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>a.search=e),class:"focus:outline-none border-b border-zinc-600 focus:border-zinc-900 mb-5 bg-transparent"},null,544),[[n.nr,a.search]])]),(0,o.Wm)(n.W3,{tag:"div",onBeforeEnter:a.beforeEnter,onEnter:a.enter,class:"grid grid-cols-1 gap-4 md:gap-6 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.computedProduct,((e,t)=>((0,o.wg)(),(0,o.j4)(c,{key:e.id,product:e,"data-index":t},null,8,["product","data-index"])))),128))])),_:1},8,["onBeforeEnter","onEnter"]),a.noSearchResult?((0,o.wg)(),(0,o.iD)("div",T,[Y,(0,o._)("div",{onClick:t[2]||(t[2]=(...e)=>a.handleClick&&a.handleClick(...e)),class:"text-medium self-start border border-zinc-600 hover:border-zinc-900 hover:text-zinc-900 px-2 py-0.5 cursor-pointer"},"Попрубуйте еще раз")])):(0,o.kq)("",!0)])}var B=r(7139);const K={class:"flex flex-col justify-between gap-4 p-4 sm:p-2 md:p-4 bg-white"},R={class:"flex flex-col"},X={class:"text-2xl font-medium text-zinc-700 serif mb-2"},G={class:"max-h-72 max-w-48 overflow-hidden"},Q=["src"],J={class:"flex flex-col gap-2 md:gap-2"},ee={class:"text-sm trac line-clamp tracking-wider line-clamp-2 sm:line-clamp-1 md:line-clamp-2"},te=(0,o._)("span",{class:"text-sm md:text-base"},"Описание: ",-1),re={class:"flex justify-between items-end"},ne={class:"px-2 py-0.5 md:px-3 md:py-1.5 bg-main text-white/90 self-start justify-self-center font-serif font-bold rounded"},oe=(0,o._)("span",{class:"text-sm font-normal tracking-wide"},"Цена за кг: ",-1),ae={class:"flex justify-between gap-4"},le={class:"text-sm"},se={class:"underline font-medium serif tracking-wide text-sm"};function ie(e,t,r,n,a,l){const s=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",K,[(0,o._)("div",R,[(0,o._)("div",X,(0,B.zw)(r.product.title),1),(0,o._)("div",G,[(0,o._)("img",{class:"w-full cursor-pointer",onClick:t[0]||(t[0]=(...e)=>n.showImg&&n.showImg(...e)),src:r.product.imageUrl,alt:""},null,8,Q)])]),(0,o._)("div",J,[(0,o._)("div",ee,[te,(0,o.Uk)((0,B.zw)(r.product.description),1)]),(0,o._)("div",re,[(0,o._)("div",ne,[oe,(0,o.Uk)(" "+(0,B.zw)(r.product.price)+" ₽ ",1)])]),(0,o._)("div",ae,[(0,o._)("div",le,[(0,o.Uk)("Продавец: "),(0,o._)("span",se,(0,B.zw)(r.product.userName),1)]),(0,o.Wm)(s,{to:{name:"ProductDescription",params:{id:r.product.id}},class:"px-1 py-0.5 border border-zinc-500 shadow-sm md:shadow-md text-xs hover:scale-105 active:scale-100 active:tranzinc-y-0.5 duration-100 transition tracking-wider self-end"},{default:(0,o.w5)((()=>[(0,o.Uk)("Подробнее")])),_:1},8,["to"])])])])}var ce={name:"Product",props:["product"],setup(e){const t=()=>{window.open(e.product.imageUrl)};return{showImg:t}}};const de=(0,j.Z)(ce,[["render",ie]]);var ue=de,pe=r(8552),me={name:"Products",components:{Product:ue},props:["products"],setup(e){const{user:t}=U(),r=(0,m.iH)(""),n=(0,m.iH)(null),a=(0,o.Fl)((()=>{if(""!==r.value){const t=e.products.filter((e=>e.title.includes(r.value)));return 0===t.length?n.value=!0:t}return e.products})),l=()=>{r.value="",n.value=!1},s=e=>{e.style.opacity=0,e.style.transform="translateX(-100px)"},i=(e,t)=>{pe.ZP.to(e,{opacity:1,x:0,duration:.6,onComplete:t,delay:.2*e.dataset.index})};return{search:r,computedProduct:a,noSearchResult:n,handleClick:l,user:t,beforeEnter:s,enter:i}}};const fe=(0,j.Z)(me,[["render",$]]);var ve=fe;const ge=(e,t)=>{const r=(0,m.iH)(null),n=(0,m.iH)(null);let a=g.collection(e).orderBy("createdAt","desc");t&&(a=a.where(...t));const l=a.onSnapshot((e=>{let t=[];e.docs.forEach((e=>{e.data().createdAt&&t.push({...e.data(),id:e.id})})),r.value=t,n.value=null}),(e=>{r.value=null,n.value=`Ошибка: ${e.message}`}));return(0,o.m0)((e=>{e((()=>l()))})),{error:n,products:r}};var xe=ge;const we=(0,o._)("div",{class:"absolute top-1/3 left-1/2 -translate-x-1/2"},[(0,o._)("div",{class:"w-16 h-16 border-2 rounded-full solid transparent border-t-zinc-700 animate-rotate"})],-1);function he(e,t,r,n,a,l){return(0,o.wg)(),(0,o.j4)(o.lR,{to:"body"},[we])}var be={};const ye=(0,j.Z)(be,[["render",he]]);var ke=ye,_e={name:"HomeView",components:{Products:ve,Spinner:ke},setup(){const{error:e,products:t}=xe("products");return{error:e,products:t}}};const ze=(0,j.Z)(_e,[["render",Z]]);var De=ze;const Pe={class:"text-center w-full"},He={class:"error"},Ue={key:0,class:"self-start"},Ce={key:1,class:"self-start",disabled:""};function je(e,t,r,a,l,s){return(0,o.wg)(),(0,o.iD)("div",Pe,[(0,o._)("form",{onSubmit:t[3]||(t[3]=(0,n.iM)(((...e)=>a.handleSubmit&&a.handleSubmit(...e)),["prevent"])),class:"inline-flex flex-col gap-4 w-full sm:w-2/3 md:w-[400px] p-6 bg-white rounded text-sm"},[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.userName=e),type:"text",placeholder:"Имя",class:"px-2 py-2 placeholder:text-xs md:placeholder:text-sm tracking-wide font-medium focus:outline-none required border-b-2 border-transparent focus:valid:border-zinc-500 focus:invalid:border-red-400 caret-zinc-500",minlength:"3"},null,512),[[n.nr,a.userName]]),(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.email=e),type:"email",placeholder:"Email",class:"px-2 py-2 placeholder:text-xs md:placeholder:text-sm tracking-wide font-medium focus:outline-none required border-b-2 border-transparent focus:valid:border-zinc-500 focus:invalid:border-red-400 caret-zinc-500"},null,512),[[n.nr,a.email]]),(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.password=e),type:"password",placeholder:"Пароль",class:"px-2 py-2 placeholder:text-xs md:placeholder:text-sm tracking-wide font-medium focus:outline-none required border-b-2 border-transparent focus:valid:border-zinc-500 focus:invalid:border-red-400 caret-zinc-500",minlength:"4",autocomplete:"on"},null,512),[[n.nr,a.password]]),(0,o._)("div",He,(0,B.zw)(a.error),1),a.isPending?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("button",Ue,"Регистрация")),a.isPending?((0,o.wg)(),(0,o.iD)("button",Ce,"Регистрация")):(0,o.kq)("",!0)],32)])}const qe=(0,m.iH)(null),Ee=(0,m.iH)(!1),We=async(e,t,r)=>{qe.value=null,Ee.value=!0;try{const n=await x.createUserWithEmailAndPassword(e,t).then((e=>{}));return await n.user.updateProfile({displayName:r}),qe.value=null,Ee.value=!1,n}catch(n){qe.value=`Ошибка: ${n.message}`,Ee.value=!1}},Ie=()=>({error:qe,signup:We,isPending:Ee});var Se=Ie,Ze={name:"Signup",setup(){const e=(0,m.iH)(""),t=(0,m.iH)(""),r=(0,m.iH)(""),n=(0,D.tv)(),{error:o,signup:a,isPending:l}=Se(),s=async()=>{await a(t.value,r.value,e.value),o.value||n.push({name:"Home"})};return{userName:e,email:t,password:r,handleSubmit:s,error:o,isPending:l}}};const Ae=(0,j.Z)(Ze,[["render",je]]);var Ne=Ae;const Ve={class:"display flex justify-center relative"},Oe=(0,o._)("div",{class:"absolute flex flex-col left-4 -bottom-32"},[(0,o._)("div",{class:"font-bold text-sm"},"Воспользуйтесь для тестирование: "),(0,o._)("div",{class:"text-sm font-serif"},[(0,o.Uk)("login: shatlyk@mail.ru "),(0,o._)("br"),(0,o.Uk)(" password: test123")]),(0,o._)("br"),(0,o._)("div",{class:"text-sm font-serif"},[(0,o.Uk)("login: igor@mail.ru "),(0,o._)("br"),(0,o.Uk)(" password: test123")])],-1),Fe={class:"error"},Me={key:0,class:"self-start"},Le={key:1,class:"self-start",disabled:""};function Te(e,t,r,a,l,s){return(0,o.wg)(),(0,o.iD)("div",Ve,[Oe,(0,o._)("form",{onSubmit:t[2]||(t[2]=(0,n.iM)(((...e)=>a.handleSubmit&&a.handleSubmit(...e)),["prevent"])),class:"inline-flex flex-col gap-4 w-full sm:w-2/3 md:w-[400px] p-6 bg-white rounded text-sm"},[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.email=e),type:"email",placeholder:"Email",class:"px-2 py-2 placeholder:text-xs md:placeholder:text-sm tracking-wide font-medium focus:outline-none required border-b-2 border-transparent focus:valid:border-zinc-500 focus:invalid:border-red-400 caret-zinc-500"},null,512),[[n.nr,a.email]]),(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),type:"password",placeholder:"Пароль",class:"px-2 py-2 placeholder:text-xs md:placeholder:text-sm tracking-wide font-medium focus:outline-none required border-b-2 border-transparent focus:valid:border-zinc-500 focus:invalid:border-red-400 caret-zinc-500",minlength:"4",autocomplete:"on"},null,512),[[n.nr,a.password]]),(0,o._)("div",Fe,(0,B.zw)(a.error),1),a.isPending?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("button",Me,"Войти")),a.isPending?((0,o.wg)(),(0,o.iD)("button",Le,"Войти")):(0,o.kq)("",!0)],32)])}const Ye=(0,m.iH)(null),$e=(0,m.iH)(!1),Be=async(e,t)=>{Ye.value=null,$e.value=!0;try{const r=await x.signInWithEmailAndPassword(e,t);return Ye.value=null,$e.value=!1,r}catch(r){Ye.value=`Ошибка: ${r.message}`,$e.value=!1}},Ke=()=>({error:Ye,login:Be,isPending:$e});var Re=Ke,Xe={name:"Login",setup(){const{error:e,login:t,isPending:r}=Re(),n=(0,m.iH)(""),o=(0,m.iH)(""),a=(0,D.tv)(),l=async()=>{await t(n.value,o.value),e.value||a.push({name:"MyProducts"})};return{email:n,password:o,error:e,login:t,isPending:r,handleSubmit:l}}};const Ge=(0,j.Z)(Xe,[["render",Te]]);var Qe=Ge;const Je=e=>((0,o.dD)("data-v-04407f22"),e=e(),(0,o.Cn)(),e),et={class:"px-2"},tt=Je((()=>(0,o._)("h2",{class:"inline-block text-lg md:text-xl px-4 py-2 ring-1 shadow-md ring-zinc-300 rounded bg-zinc-200 text-black/80 mx-auto mb-3"},"Описание вашего товара",-1))),rt={class:"flex flex-col gap-1"},nt=Je((()=>(0,o._)("label",{for:"name"},"Название",-1))),ot={class:"flex flex-col gap-1"},at=Je((()=>(0,o._)("label",{for:"description"},"Описание товара",-1))),lt={class:"flex gap-4"},st={class:"flex flex-col w-1/2 gap-1"},it=Je((()=>(0,o._)("label",{for:"category",class:"text-sm sm:text-base"},"Категория",-1))),ct=Je((()=>(0,o._)("option",{value:"Сухофрукты"},"Сухофрукты",-1))),dt=Je((()=>(0,o._)("option",{value:"Фрукты"},"Фрукты",-1))),ut=Je((()=>(0,o._)("option",{value:"Овощи"},"Овощи",-1))),pt=[ct,dt,ut],mt={class:"flex flex-col gap-1"},ft=Je((()=>(0,o._)("label",{for:"price",class:"text-sm sm:text-base"},"Цена в рублях (за кг)",-1))),vt={class:"flex flex-col gap-1"},gt=Je((()=>(0,o._)("label",null,"Выберите фото",-1))),xt={class:"flex gap-3 items-center"},wt=Je((()=>(0,o._)("label",{for:"image",class:"text-xs px-3 py-[5px] bg-zinc-200 ring-2 ring-zinc-300 self-start rounded hover:bg-zinc-300 hover:text-black/70 hover:shadow transition-all cursor-pointer active:tranzinc-y-1 active:scale-95 select-none"}," фото ",-1))),ht={key:0,class:"text-xs"},bt={key:0,class:"text-sm mt-2 text-orange-400 serif tracking-wide"},yt={key:0,class:"text-sm mt-2 text-orange-400 serif tracking-wide"},kt={key:0,class:"self-start px-4 py-2"},_t={key:1,class:"self-start px-4 py-2",disabled:""};function zt(e,t,r,a,l,s){return(0,o.wg)(),(0,o.iD)("div",et,[(0,o._)("form",{onSubmit:t[5]||(t[5]=(0,n.iM)(((...e)=>a.handleCreate&&a.handleCreate(...e)),["prevent"])),class:"p-2 sm:p-4 md:p-8 sm:max-w-[500px] mx-auto bg-zinc-100 flex flex-col gap-4 md:gap-6 tracking-wide"},[tt,(0,o._)("div",rt,[nt,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.title=e),class:"placeholder:font-thin placeholder:text-sm placeholder:tracking-wide px-2 py-1 focus:outline-none caret-zinc-300 text-sm tracking-tight focus:ring-2 ring-zinc-400",type:"text",id:"name",placeholder:"Лимоны узбекские, дыня торпеда..."},null,512),[[n.nr,a.title]])]),(0,o._)("div",ot,[at,(0,o.wy)((0,o._)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.description=e),class:"placeholder:font-thin placeholder:text-sm placeholder:tracking-wide px-2 py-1 focus:outline-none caret-zinc-300 text-sm h-16 focus:ring-2 ring-zinc-400",type:"text",id:"description",placeholder:"Краткое описание товара"},null,512),[[n.nr,a.description]])]),(0,o._)("div",lt,[(0,o._)("div",st,[it,(0,o.wy)((0,o._)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.category=e),class:"px-2 py-1 focus:outline-none w-full text-sm serif tracking-wider focus:ring-2 ring-zinc-400"},pt,512),[[n.bM,a.category]])]),(0,o._)("div",mt,[ft,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>a.price=e),class:"w-full px-2 py-1 focus:outline-none text-sm serif tracking-wider caret-zinc-400 focus:ring-2 ring-zinc-400",type:"number",id:"price"},null,512),[[n.nr,a.price]])])]),(0,o._)("div",vt,[gt,(0,o._)("div",xt,[wt,a.image?((0,o.wg)(),(0,o.iD)("div",ht,(0,B.zw)(a.image.name),1)):(0,o.kq)("",!0)]),(0,o._)("input",{onChange:t[4]||(t[4]=(...e)=>a.changeImage&&a.changeImage(...e)),class:"text-xs hidden",id:"image",type:"file"},null,32),(0,o.Wm)(n.uT,{name:"imgError"},{default:(0,o.w5)((()=>[a.imageFormatError?((0,o.wg)(),(0,o.iD)("div",bt,(0,B.zw)(a.imageFormatError),1)):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(n.uT,{name:"imgError"},{default:(0,o.w5)((()=>[a.unchoosenError?((0,o.wg)(),(0,o.iD)("div",yt,(0,B.zw)(a.unchoosenError),1)):(0,o.kq)("",!0)])),_:1})]),a.isPending?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("button",kt,"Создать товар")),a.isPending?((0,o.wg)(),(0,o.iD)("button",_t,"Создать товар")):(0,o.kq)("",!0)],32)])}const Dt=e=>{const t=(0,m.iH)(null),r=(0,m.iH)(!1),n=async n=>{t.value=null,r.value=!0;try{const t=await g.collection(e).add(n);return r.value=!1,t}catch(o){t.value=`Ошибка: ${o.message}`,r.value=!1}};return{error:t,addDoc:n,isPending:r}};var Pt=Dt;const{user:Ht}=U(),Ut=()=>{const e=(0,m.iH)(null),t=(0,m.iH)(null),r=(0,m.iH)(null),n=async n=>{r.value=`images/${Ht.value.uid}/${n.name}`;const o=w.ref(r.value);try{const e=await o.put(n);t.value=await e.ref.getDownloadURL()}catch(a){e.value=a.message}},o=async t=>{const r=w.ref(t);try{await r.delete()}catch(n){e.value=`Ошибка: ${n.message}`}};return{error:e,url:t,filePath:r,uploadImage:n,deleteImage:o}};var Ct=Ut,jt={name:"AddProduct",setup(){const{error:e,addDoc:t}=Pt("products"),{url:r,filePath:n,uploadImage:o}=Ct(),{user:a}=U(),l=(0,m.iH)(""),s=(0,m.iH)(""),i=(0,m.iH)(""),c=(0,m.iH)(""),d=(0,m.iH)(null),u=(0,m.iH)(null),p=(0,m.iH)(null),f=(0,m.iH)(!1),v=["image/png","image/jpeg"],g=e=>{let t=e.target.files[0];t&&v.includes(t.type)?(d.value=t,console.log(e.target.files[0])):(d.value=null,u.value="Пожалуйста, выберите изображения формата png/jpeg",setTimeout((()=>{u.value=null}),4e3))},x=async()=>{if(d.value){f.value=!0,await o(d.value);await t({title:l.value,description:s.value,category:i.value,price:c.value,imageUrl:r.value,filePath:n.value,userName:a.value.displayName,userUid:a.value.uid,createdAt:h()});f.value=!1,e.value||$r.push({name:"Home"})}else p.value="Пожалуйста, выберите фото",setTimeout((()=>{p.value=null}),3e3)};return{title:l,description:s,category:i,price:c,handleCreate:x,changeImage:g,imageFormatError:u,image:d,isPending:f,unchoosenError:p}}};const qt=(0,j.Z)(jt,[["render",zt],["__scopeId","data-v-04407f22"]]);var Et=qt;const Wt={class:"px-2 md:px-4"},It={key:0,class:"w-full p-4 md:p-6 bg-white"},St={class:"mx-auto flex flex-col md:flex-row gap-4 md:gap-8"},Zt={class:"md:w-1/2"},At=["src"],Nt={class:"flex flex-col justify-between gap-2 md:w-1/2"},Vt={class:"text-xl md:text-2xl font-medium self-center serif mb-2 md:mb-4"},Ot={class:"text-sm trac line-clamp tracking-wider"},Ft={class:"flex justify-between gap-2"},Mt={class:"flex flex-col gap-2"},Lt={class:"px-2 py-0.5 md:px-3 md:py-1.5 text-xs sm:text-sm bg-main text-white/90 font-medium self-start justify-self-center serif tracking-wider rounded"},Tt=(0,o._)("span",{class:"font-normal"},"Цена за кг: ",-1),Yt={class:"text-sm"},$t={class:"underline font-medium serif tracking-wide text-sm"},Bt={key:0,class:"mt-auto flex flex-col gap-1 items-center"},Kt=(0,o._)("h5",{class:"text-xs text-zinc-400 font-bold"},"Это ваш товар",-1),Rt={key:1,class:"text-xs px-2 py-1 border border-transparent text-zinc-400 cursor-not-allowed bg-zinc-100 rounded-full transition duration-200 active:scale-95 select-none self-end",disabled:""},Xt={class:"bg-zinc-50 mt-2 px-2 py-3"},Gt={key:1},Qt={key:0,class:"error px-6 py-6"};function Jt(e,t,r,n,a,l){const s=(0,o.up)("CommentsForm"),i=(0,o.up)("Spinner");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",Wt,[n.product?((0,o.wg)(),(0,o.iD)("div",It,[(0,o._)("div",St,[(0,o._)("div",Zt,[(0,o._)("img",{src:n.product.imageUrl,class:"w-full",alt:""},null,8,At)]),(0,o._)("div",Nt,[(0,o._)("div",null,[(0,o._)("div",Vt,(0,B.zw)(n.product.title),1),(0,o._)("div",Ot,(0,B.zw)(n.product.description),1)]),(0,o._)("div",Ft,[(0,o._)("div",Mt,[(0,o._)("div",Lt,[Tt,(0,o.Uk)(" "+(0,B.zw)(n.product.price)+" ₽",1)]),(0,o._)("div",Yt,[(0,o.Uk)("Продавец: "),(0,o._)("span",$t,(0,B.zw)(n.product.userName),1)])]),((0,o.wg)(),(0,o.iD)("div",Bt,[Kt,n.isPending?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",{key:0,onClick:t[0]||(t[0]=(...e)=>n.handleDelete&&n.handleDelete(...e)),class:"text-xs px-2 py-1 border border-red-400 text-red-400 hover:bg-transparent hover:text-red-600 hover:border-red-600 rounded-full cursor-pointer transition duration-200 active:scale-95 select-none self-end"},"Удалить товар")),n.isPending?((0,o.wg)(),(0,o.iD)("div",Rt,"Удалить товар")):(0,o.kq)("",!0)]))])])]),(0,o._)("div",Xt,[(0,o.Wm)(s,{id:r.id},null,8,["id"])])])):((0,o.wg)(),(0,o.iD)("div",Gt,[(0,o.Wm)(i)]))]),n.error?((0,o.wg)(),(0,o.iD)("div",Qt,(0,B.zw)(n.error),1)):(0,o.kq)("",!0)],64)}const er={class:"mb-4"},tr=(0,o._)("h2",{class:"mb-2 text-lg font-medium text-zinc-700"},"Комментарии",-1),rr={key:1,type:"text",placeholder:"Отправляем...",class:"px-1 py-2 placeholder:text-xs tracking-wide font-medium focus:outline-none required border-b-2 border-transparent focus:border-b-zinc-500 caret-zinc-700 w-1/2",disabled:""},nr={key:2,type:"text",placeholder:"Войдите что бы оставлять коментарии",class:"px-1 py-2 placeholder:text-xs tracking-wide font-medium focus:outline-none required border-b-2 border-transparent focus:border-b-zinc-500 caret-zinc-700 w-1/2",disabled:""},or={key:3,class:"error"},ar={class:"max-h-60 overflow-auto"};function lr(e,t,r,a,l,s){const i=(0,o.up)("CommentsView");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",er,[tr,!a.isPending&&a.currentUser?(0,o.wy)(((0,o.wg)(),(0,o.iD)("input",{key:0,onKeyup:t[0]||(t[0]=(0,n.D2)(((...e)=>a.handleComment&&a.handleComment(...e)),["enter"])),"onUpdate:modelValue":t[1]||(t[1]=e=>a.title=e),type:"text",placeholder:"Нажмите Enter для отправки",class:"px-1 py-2 placeholder:text-xs tracking-wide font-medium focus:outline-none required border-b-2 border-transparent focus:border-b-zinc-500 caret-zinc-700 w-1/2"},null,544)),[[n.nr,a.title,void 0,{trim:!0}]]):(0,o.kq)("",!0),a.isPending?((0,o.wg)(),(0,o.iD)("input",rr)):(0,o.kq)("",!0),a.currentUser?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("input",nr)),a.error?((0,o.wg)(),(0,o.iD)("div",or,(0,B.zw)(a.error),1)):(0,o.kq)("",!0)]),(0,o._)("div",ar,[(0,o.Wm)(i,{id:r.id},null,8,["id"])])],64)}const sr={class:"relative"},ir={class:"text-base font-extrabold font-serif"},cr={class:"text-sm"},dr={class:"text-xs` text-zinc-500 text-xs"},ur=["onClick"],pr={key:0,class:"error"};function mr(e,t,r,a,l,s){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",sr,[(0,o.Wm)(n.uT,{name:"comments",mode:"in-out"},{default:(0,o.w5)((()=>[(0,o.Wm)(n.W3,{tag:"ul",name:"list",appear:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.formatDate,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"w-1/2 relative",key:e.id},[(0,o._)("div",ir,(0,B.zw)(e.author),1),(0,o._)("div",cr,(0,B.zw)(e.title),1),(0,o._)("div",dr,(0,B.zw)(e.createdAt)+" назад",1),e.author==a.currentUser?((0,o.wg)(),(0,o.iD)("div",{key:0,onClick:t=>a.handleDelete(e.commentId),class:"text-xs text-red-400 hover:text-red-500 transition-all hover:border-b-red-500 cursor-pointer active:scale-95 select-none absolute right-0 bottom-0"},"удалить",8,ur)):(0,o.kq)("",!0)])))),128))])),_:1})])),_:1})]),a.error?((0,o.wg)(),(0,o.iD)("div",pr,(0,B.zw)(a.error),1)):(0,o.kq)("",!0)],64)}var fr=r(7737),vr=r(6794),gr={name:"CommentsView",props:["id"],setup(e){const{products:t,error:r}=xe("comments",["docId","==",e.id]),{user:n}=U(),a=(0,o.Fl)((()=>{if(n.value)return n.value.displayName})),l=new Date,s=(0,o.Fl)((()=>{if(t.value)return t.value.map((e=>{let t=Number(e.createdAt.toDate()),r=(0,fr.Z)(t,l,{locale:vr.Z});return{...e,createdAt:r}}))})),i=async e=>{await g.collection("comments").doc(e).delete()};return{comments:t,handleDelete:i,formatDate:s,user:n,currentUser:a,error:r}}};const xr=(0,j.Z)(gr,[["render",mr]]);var wr=xr,hr={name:"CommentsForm",components:{CommentsView:wr},props:["id"],setup(e){const t=(0,m.iH)(""),r=(0,m.iH)(null),{user:n}=U(),{addDoc:o,error:a,isPending:l}=Pt("comments"),s=n.value,i=async()=>{if(n.value&&""!==t.value){const l={author:n.value.displayName,title:t.value,createdAt:h(),docId:e.id,commentId:""};await o(l).then((e=>{r.value=e.id,g.collection("comments").doc(r.value).update({commentId:r.value})})),a.value||(t.value="")}};return{title:t,handleComment:i,isPending:l,currentUser:s,error:a}}};const br=(0,j.Z)(hr,[["render",lr]]);var yr=br;const kr=(e,t)=>{const r=(0,m.iH)(null),n=(0,m.iH)(null);let a=g.collection(e).doc(t);const l=a.onSnapshot((e=>{e.data()?(r.value={...e.data(),id:e.id},n.value=null):n.value="Этот документ более не существует"}));return(0,o.m0)((e=>{e((()=>l()))})),{error:n,document:r}};var _r=kr;const zr=(e,t)=>{const r=(0,m.iH)(null),n=(0,m.iH)(!1);let o=g.collection(e).doc(t);const a=async()=>{n.value=!0,r.value=null;try{const e=await o.delete();return n.value=!1,e}catch(e){n.value=!1,r.value="Could not delete the document"}},l=async e=>{n.value=!0,r.value=null;try{const t=await o.update(e);return n.value=!1,t}catch(t){n.value=!1,r.value=`Ошибка: ${t.message}`}};return{error:r,isPending:n,deleteDoc:a,updateDoc:l}};var Dr=zr,Pr={name:"ProductDescription",props:["id"],components:{CommentsForm:yr,Spinner:ke},setup(e){const{error:t,document:r}=_r("products",e.id),{deleteDoc:n}=Dr("products",e.id),{products:a}=xe("comments",["docId","==",e.id]),{deleteImage:l}=Ct(),{user:s}=U(),i=(0,m.iH)(null),c=(0,D.tv)(),d=(0,o.Fl)((()=>r.value&&s.value&&s.value.uid==r.value.userUid)),u=async()=>{i.value=!0,await l(r.value.filePath),await n();for(let e=0;e<a.value.length;e++){let t=a.value[e].commentId;const{deleteDoc:r}=Dr("comments",t);r()}i.value=!1,c.push({name:"Home"})};return{error:t,product:r,userProduct:d,handleDelete:u,isPending:i}}};const Hr=(0,j.Z)(Pr,[["render",Jt]]);var Ur=Hr;const Cr={class:"px-4 relative"},jr={class:"mb-4 md:mb-6 flex flex-col gap-2"},qr=(0,o._)("h2",{class:"text-2xl sm:text-3xl md:text-4xl font-medium serif"},"Мои товары",-1),Er={key:2,class:"error"};function Wr(e,t,r,a,l,s){const i=(0,o.up)("router-link"),c=(0,o.up)("Product"),d=(0,o.up)("Spinner");return(0,o.wg)(),(0,o.iD)("div",Cr,[(0,o._)("div",jr,[qr,(0,o.Wm)(i,{to:{name:"Home"},class:"text-sm md:text-base font-serif font-bold text-orange-400 border-b border-orange-400 self-start hover:border-b-transparent duration-300"},{default:(0,o.w5)((()=>[(0,o.Uk)("Перейти на рынок")])),_:1})]),a.products?((0,o.wg)(),(0,o.j4)(n.W3,{key:0,tag:"div",onBeforeEnter:a.beforeEnter,onEnter:a.enter,class:"grid grid-cols-1 gap-4 md:gap-6 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.products,((e,t)=>((0,o.wg)(),(0,o.j4)(c,{key:e.id,product:e,"data-index":t},null,8,["product","data-index"])))),128))])),_:1},8,["onBeforeEnter","onEnter"])):((0,o.wg)(),(0,o.j4)(d,{key:1})),a.error?((0,o.wg)(),(0,o.iD)("div",Er,(0,B.zw)(a.error),1)):(0,o.kq)("",!0)])}var Ir={name:"MyProducts",components:{Product:ue,Spinner:ke},setup(){const{user:e}=U(),{error:t,products:r}=xe("products",["userUid","==",e.value.uid]),n=e=>{e.style.opacity=0,e.style.transform="translateX(-100px)"},o=(e,t)=>{pe.ZP.to(e,{opacity:1,x:0,duration:.6,onComplete:t,delay:.2*e.dataset.index})};return{error:t,products:r,user:e,beforeEnter:n,enter:o}}};const Sr=(0,j.Z)(Ir,[["render",Wr]]);var Zr=Sr;const Ar={class:"font-serif flex flex-col gap-6 items-center px-4"},Nr=(0,o._)("div",null," Кажется, такоей страницы не существует... ",-1);function Vr(e,t,r,n,a,l){const s=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",Ar,[Nr,(0,o._)("div",null,[(0,o.Wm)(s,{to:{name:"Home"},class:"text-sm md:text-base font-serif font-bold text-orange-400 border-b border-orange-400 self-start hover:border-b-transparent duration-300"},{default:(0,o.w5)((()=>[(0,o.Uk)("Перейти на главную")])),_:1})])])}var Or={};const Fr=(0,j.Z)(Or,[["render",Vr]]);var Mr=Fr;const Lr=(e,t,r)=>{let n=x.currentUser;n?r():r({name:"Login"})},Tr=[{path:"/",name:"Home",component:De},{path:"/register",name:"Signup",component:Ne},{path:"/login",name:"Login",component:Qe},{path:"/add-product",name:"AddProduct",component:Et,beforeEnter:Lr},{path:"/product-description/:id",name:"ProductDescription",component:Ur,props:!0},{path:"/myProducts",name:"MyProducts",component:Zr,beforeEnter:Lr},{path:"/:catchAll(.*)",name:"NotFound",component:Mr}],Yr=(0,D.p7)({history:(0,D.PO)("/"),routes:Tr});var $r=Yr;let Br;x.onAuthStateChanged((()=>{Br||(Br=(0,n.ri)(S).use($r).mount("#app"))}))}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.m=e,function(){var e=[];r.O=function(t,n,o,a){if(!n){var l=1/0;for(d=0;d<e.length;d++){n=e[d][0],o=e[d][1],a=e[d][2];for(var s=!0,i=0;i<n.length;i++)(!1&a||l>=a)&&Object.keys(r.O).every((function(e){return r.O[e](n[i])}))?n.splice(i--,1):(s=!1,a<l&&(l=a));if(s){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[n,o,a]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,a,l=n[0],s=n[1],i=n[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(o in s)r.o(s,o)&&(r.m[o]=s[o]);if(i)var d=i(r)}for(t&&t(n);c<l.length;c++)a=l[c],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(d)},n=self["webpackChunkpet_proj"]=self["webpackChunkpet_proj"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=r.O(void 0,[998],(function(){return r(4213)}));n=r.O(n)})();
//# sourceMappingURL=app.de81aebc.js.map