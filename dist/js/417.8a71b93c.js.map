{"version":3,"file":"js/417.8a71b93c.js","mappings":"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","sources":["webpack://pet-proj/./src/composables/useCollection.js","webpack://pet-proj/./src/composables/useStorage.js","webpack://pet-proj/./src/views/AddProduct.vue","webpack://pet-proj/./src/views/AddProduct.vue?8891"],"sourcesContent":["import { ref } from \"vue\";\nimport { projectFirestore } from \"../firebase/config\";\n\nconst useCollection = (collection) => {\n  const error = ref(null);\n  const isPending = ref(false);\n\n  const addDoc = async (doc) => {\n    error.value = null;\n    isPending.value = true;\n\n    try {\n      const res = await projectFirestore.collection(collection).add(doc);\n\n      isPending.value = false;\n      return res;\n    } catch (err) {\n      error.value = `Ошибка: ${err.message}`;\n      isPending.value = false;\n    }\n  };\n\n  return { error, addDoc, isPending };\n};\n\nexport default useCollection;\n","import { ref } from \"vue\";\r\nimport { projectStorage } from \"@/firebase/config\";\r\nimport getUser from \"@/composables/getUser\";\r\n\r\nconst { user } = getUser();\r\n\r\nconst useStorage = () => {\r\n  const error = ref(null);\r\n  const url = ref(null);\r\n  const filePath = ref(null);\r\n\r\n  const uploadImage = async (image) => {\r\n    filePath.value = `images/${user.value.uid}/${image.name}`;\r\n    const storageRef = projectStorage.ref(filePath.value);\r\n\r\n    try {\r\n      const res = await storageRef.put(image);\r\n      url.value = await res.ref.getDownloadURL();\r\n    } catch (err) {\r\n      error.value = err.message;\r\n    }\r\n  };\r\n\r\n  const deleteImage = async (path) => {\r\n    const storageRef = projectStorage.ref(path);\r\n\r\n    try {\r\n      await storageRef.delete();\r\n    } catch (err) {\r\n      error.value = `Ошибка: ${err.message}`;\r\n    }\r\n  };\r\n\r\n  return { error, url, filePath, uploadImage, deleteImage };\r\n};\r\n\r\nexport default useStorage;\r\n","<template>\r\n  <div class=\"px-2\">\r\n    <form @submit.prevent=\"handleCreate\" class=\"p-2 sm:p-4 md:p-8 sm:max-w-[500px] mx-auto bg-zinc-100 flex flex-col gap-4 md:gap-6 tracking-wide \">\r\n      <h2 class=\"inline-block text-lg md:text-xl px-4 py-2 ring-1 shadow-md ring-zinc-300 rounded bg-zinc-200 text-black/80 mx-auto mb-3\">Описание вашего товара</h2>\r\n      <div class=\"flex flex-col gap-1\">\r\n        <label for=\"name\">Название</label>\r\n        <input v-model=\"title\" class=\"placeholder:font-thin placeholder:text-sm placeholder:tracking-wide px-2 py-1 focus:outline-none caret-zinc-300 text-sm tracking-tight focus:ring-2 ring-zinc-400\" type=\"text\" id=\"name\" placeholder=\"Лимоны узбекские, дыня торпеда...\">\r\n      </div>\r\n      <div class=\"flex flex-col gap-1\">\r\n        <label for=\"description\">Описание товара</label>\r\n        <textarea v-model=\"description\" class=\"placeholder:font-thin placeholder:text-sm placeholder:tracking-wide px-2 py-1 focus:outline-none caret-zinc-300 text-sm h-16 focus:ring-2 ring-zinc-400\" type=\"text\" id=\"description\" placeholder=\"Краткое описание товара\"></textarea>\r\n      </div>\r\n      <div class=\"flex gap-4\">\r\n        <div class=\"flex flex-col w-1/2 gap-1\">\r\n          <label for=\"category\" class=\"text-sm sm:text-base\">Категория</label>\r\n          <select v-model=\"category\" class=\"px-2 py-1 focus:outline-none w-full text-sm serif tracking-wider focus:ring-2 ring-zinc-400\">\r\n            <option value=\"Сухофрукты\">Сухофрукты</option>\r\n            <option value=\"Фрукты\">Фрукты</option>\r\n            <option value=\"Овощи\">Овощи</option>\r\n          </select>\r\n        </div>\r\n        <div class=\"flex flex-col gap-1\">\r\n          <label for=\"price\" class=\"text-sm sm:text-base\">Цена в рублях (за кг)</label>\r\n          <input v-model=\"price\" class=\"w-full px-2 py-1 focus:outline-none text-sm serif tracking-wider caret-zinc-400 focus:ring-2 ring-zinc-400\" type=\"number\" id=\"price\">\r\n        </div>\r\n      </div>\r\n      <div class=\"flex flex-col gap-1\">\r\n        <label >Выберите фото</label>\r\n        <div class=\"flex gap-3 items-center\">\r\n        <label for=\"image\" class=\"text-xs px-3 py-[5px] bg-zinc-200 ring-2 ring-zinc-300 self-start rounded hover:bg-zinc-300 hover:text-black/70 hover:shadow transition-all  cursor-pointer active:tranzinc-y-1 active:scale-95 select-none\"> фото\r\n        </label>\r\n        <div v-if=\"image\" class=\"text-xs\">{{image.name}}</div>\r\n      </div>\r\n        <input @change=\"changeImage\" class=\"text-xs hidden\" id=\"image\" type=\"file\">\r\n        <transition name=\"imgError\">\r\n          <div v-if=\"imageFormatError\" class=\"text-sm mt-2 text-orange-400 serif tracking-wide\">{{imageFormatError}}</div>\r\n        </transition>\r\n        <transition name=\"imgError\">\r\n          <div v-if=\"unchoosenError\" class=\"text-sm mt-2 text-orange-400 serif tracking-wide\">{{unchoosenError}}</div>\r\n        </transition>\r\n      </div>\r\n      <button v-if=\"!isPending\" class=\"self-start px-4 py-2\">Создать товар</button>\r\n      <button v-if=\"isPending\" class=\"self-start px-4 py-2\" disabled>Создать товар</button>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { timestamp } from '@/firebase/config';\r\nimport getUser from '@/composables/getUser'\r\nimport useCollection from '@/composables/useCollection'\r\nimport useStorage from '@/composables/useStorage'\r\nimport { ref } from 'vue';\r\nimport router from '@/router';\r\n\r\n  export default {\r\n    name: 'AddProduct',\r\n\r\n    setup() {\r\n      const { error, addDoc } = useCollection('products')\r\n      const { url, filePath, uploadImage } = useStorage()\r\n      const { user } = getUser()\r\n\r\n      const title = ref('')\r\n      const description = ref('')\r\n      const category = ref('')\r\n      const price = ref('')\r\n      const image = ref(null)\r\n      const imageFormatError = ref(null)\r\n      const unchoosenError = ref(null)\r\n      const isPending = ref(false)\r\n      \r\n      const imageTypes = ['image/png', 'image/jpeg']\r\n      \r\n      const changeImage = (e) => {\r\n        let selected = e.target.files[0]\r\n        if(selected && imageTypes.includes(selected.type)) {\r\n          image.value = selected\r\n          console.log(e.target.files[0])\r\n        } else {\r\n          image.value = null\r\n          imageFormatError.value = 'Пожалуйста, выберите изображения формата png/jpeg' \r\n          setTimeout(() => {\r\n            imageFormatError.value = null\r\n          }, 4000)\r\n        }\r\n      }\r\n\r\n      const handleCreate = async () => {\r\n        if(image.value) {\r\n          isPending.value = true\r\n          await uploadImage(image.value)\r\n          const newProduct = await addDoc({\r\n            title: title.value,\r\n            description: description.value,\r\n            category: category.value,\r\n            price: price.value,\r\n            imageUrl: url.value,\r\n            filePath: filePath.value,\r\n            userName: user.value.displayName,\r\n            userUid: user.value.uid,\r\n            createdAt: timestamp()\r\n          })\r\n          isPending.value = false\r\n          if(!error.value) {\r\n            router.push({name: 'Home'})\r\n          }\r\n        } else {\r\n          unchoosenError.value = 'Пожалуйста, выберите фото' \r\n          setTimeout(() => {\r\n            unchoosenError.value = null\r\n          }, 3000)\r\n        }\r\n      }\r\n\r\n      return {title, description, category, price, handleCreate, changeImage, imageFormatError, image, isPending, unchoosenError}\r\n    }\r\n    \r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n/* TRANSITIONS */\r\n\r\n@keyframes wobble {\r\n  0% {\r\n    transform: translateY(1rem);\r\n    opacity: 0;\r\n  }\r\n  30% {\r\n    transform: translateY(0rem);\r\n    opacity: 1;\r\n  }\r\n  40% {\r\n    transform: translateX(6px);\r\n  }\r\n  50% {\r\n    transform: translateX(-6px);\r\n  }\r\n  60% {\r\n    transform: translateX(6px);\r\n  }\r\n  70% {\r\n    transform: translateX(-6px);\r\n  }\r\n  80% {\r\n    transform: translateX(6px);\r\n  }\r\n  90% {\r\n    transform: translateX(-6px);\r\n  }\r\n  100% {\r\n    transform: translateX(6px);\r\n  }\r\n}\r\n.imgError-enter-from {\r\n  opacity: 0;\r\n  transform: translateY(-2rem);\r\n}\r\n\r\n.imgError-enter-to {\r\n  opacity: 1;\r\n  transform: translateY(0);\r\n}\r\n\r\n.imgError-enter-active {\r\n  animation: wobble 0.5s ease;\r\n}\r\n\r\n</style>","import { render } from \"./AddProduct.vue?vue&type=template&id=04407f22&scoped=true\"\nimport script from \"./AddProduct.vue?vue&type=script&lang=js\"\nexport * from \"./AddProduct.vue?vue&type=script&lang=js\"\n\nimport \"./AddProduct.vue?vue&type=style&index=0&id=04407f22&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\pengu\\\\Desktop\\\\pet-proj\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-04407f22\"]])\n\nexport default __exports__"],"names":["useCollection","collection","error","ref","isPending","addDoc","async","value","res","projectFirestore","add","doc","err","message","user","getUser","useStorage","url","filePath","uploadImage","uid","image","name","storageRef","projectStorage","put","getDownloadURL","deleteImage","path","delete","class","_createElementVNode","for","_hoisted_10","_hoisted_11","_hoisted_12","disabled","_createElementBlock","_hoisted_1","onSubmit","$setup","_hoisted_2","_hoisted_3","_hoisted_4","type","id","placeholder","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","onChange","_createVNode","_Transition","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","setup","title","description","category","price","imageFormatError","unchoosenError","imageTypes","changeImage","e","selected","target","files","includes","console","log","setTimeout","handleCreate","imageUrl","userName","displayName","userUid","createdAt","timestamp","router","__exports__","render"],"sourceRoot":""}