"use strict";(self["webpackChunkpet_proj"]=self["webpackChunkpet_proj"]||[]).push([[417],{402:function(e,a,l){var t=l(4870),i=l(7732);const n=e=>{const a=(0,t.iH)(null),l=(0,t.iH)(!1),n=async t=>{a.value=null,l.value=!0;try{const a=await i.H1.collection(e).add(t);return l.value=!1,a}catch(n){a.value=`Ошибка: ${n.message}`,l.value=!1}};return{error:a,addDoc:n,isPending:l}};a["Z"]=n},1434:function(e,a,l){var t=l(4870),i=l(7732),n=l(9944);const{user:r}=(0,n.Z)(),s=()=>{const e=(0,t.iH)(null),a=(0,t.iH)(null),l=(0,t.iH)(null),n=async t=>{l.value=`images/${r.value.uid}/${t.name}`;const n=i.vY.ref(l.value);try{const e=await n.put(t);a.value=await e.ref.getDownloadURL()}catch(s){e.value=s.message}},s=async a=>{const l=i.vY.ref(a);try{await l.delete()}catch(t){e.value=`Ошибка: ${t.message}`}};return{error:e,url:a,filePath:l,uploadImage:n,deleteImage:s}};a["Z"]=s},3417:function(e,a,l){l.r(a),l.d(a,{default:function(){return N}});var t=l(3396),i=l(9242),n=l(7139);const r=e=>((0,t.dD)("data-v-04407f22"),e=e(),(0,t.Cn)(),e),s={class:"px-2"},c=r((()=>(0,t._)("h2",{class:"inline-block text-lg md:text-xl px-4 py-2 ring-1 shadow-md ring-zinc-300 rounded bg-zinc-200 text-black/80 mx-auto mb-3"},"Описание вашего товара",-1))),o={class:"flex flex-col gap-1"},u=r((()=>(0,t._)("label",{for:"name"},"Название",-1))),d={class:"flex flex-col gap-1"},g=r((()=>(0,t._)("label",{for:"description"},"Описание товара",-1))),p={class:"flex gap-4"},m={class:"flex flex-col w-1/2 gap-1"},f=r((()=>(0,t._)("label",{for:"category",class:"text-sm sm:text-base"},"Категория",-1))),v=r((()=>(0,t._)("option",{value:"Сухофрукты"},"Сухофрукты",-1))),x=r((()=>(0,t._)("option",{value:"Фрукты"},"Фрукты",-1))),h=r((()=>(0,t._)("option",{value:"Овощи"},"Овощи",-1))),w=[v,x,h],y={class:"flex flex-col gap-1"},_=r((()=>(0,t._)("label",{for:"price",class:"text-sm sm:text-base"},"Цена в рублях (за кг)",-1))),k={class:"flex flex-col gap-1"},b=r((()=>(0,t._)("label",null,"Выберите фото",-1))),z={class:"flex gap-3 items-center"},H=r((()=>(0,t._)("label",{for:"image",class:"text-xs px-3 py-[5px] bg-zinc-200 ring-2 ring-zinc-300 self-start rounded hover:bg-zinc-300 hover:text-black/70 hover:shadow transition-all cursor-pointer active:tranzinc-y-1 active:scale-95 select-none"}," фото ",-1))),D={key:0,class:"text-xs"},E={key:0,class:"text-sm mt-2 text-orange-400 serif tracking-wide"},P={key:0,class:"text-sm mt-2 text-orange-400 serif tracking-wide"},Z={key:0,class:"self-start px-4 py-2"},C={key:1,class:"self-start px-4 py-2",disabled:""};function I(e,a,l,r,v,x){return(0,t.wg)(),(0,t.iD)("div",s,[(0,t._)("form",{onSubmit:a[5]||(a[5]=(0,i.iM)(((...e)=>r.handleCreate&&r.handleCreate(...e)),["prevent"])),class:"p-2 sm:p-4 md:p-8 sm:max-w-[500px] mx-auto bg-zinc-100 flex flex-col gap-4 md:gap-6 tracking-wide"},[c,(0,t._)("div",o,[u,(0,t.wy)((0,t._)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>r.title=e),class:"placeholder:font-thin placeholder:text-sm placeholder:tracking-wide px-2 py-1 focus:outline-none caret-zinc-300 text-sm tracking-tight focus:ring-2 ring-zinc-400",type:"text",id:"name",placeholder:"Лимоны узбекские, дыня торпеда..."},null,512),[[i.nr,r.title]])]),(0,t._)("div",d,[g,(0,t.wy)((0,t._)("textarea",{"onUpdate:modelValue":a[1]||(a[1]=e=>r.description=e),class:"placeholder:font-thin placeholder:text-sm placeholder:tracking-wide px-2 py-1 focus:outline-none caret-zinc-300 text-sm h-16 focus:ring-2 ring-zinc-400",type:"text",id:"description",placeholder:"Краткое описание товара"},null,512),[[i.nr,r.description]])]),(0,t._)("div",p,[(0,t._)("div",m,[f,(0,t.wy)((0,t._)("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>r.category=e),class:"px-2 py-1 focus:outline-none w-full text-sm serif tracking-wider focus:ring-2 ring-zinc-400"},w,512),[[i.bM,r.category]])]),(0,t._)("div",y,[_,(0,t.wy)((0,t._)("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>r.price=e),class:"w-full px-2 py-1 focus:outline-none text-sm serif tracking-wider caret-zinc-400 focus:ring-2 ring-zinc-400",type:"number",id:"price"},null,512),[[i.nr,r.price]])])]),(0,t._)("div",k,[b,(0,t._)("div",z,[H,r.image?((0,t.wg)(),(0,t.iD)("div",D,(0,n.zw)(r.image.name),1)):(0,t.kq)("",!0)]),(0,t._)("input",{onChange:a[4]||(a[4]=(...e)=>r.changeImage&&r.changeImage(...e)),class:"text-xs hidden",id:"image",type:"file"},null,32),(0,t.Wm)(i.uT,{name:"imgError"},{default:(0,t.w5)((()=>[r.imageFormatError?((0,t.wg)(),(0,t.iD)("div",E,(0,n.zw)(r.imageFormatError),1)):(0,t.kq)("",!0)])),_:1}),(0,t.Wm)(i.uT,{name:"imgError"},{default:(0,t.w5)((()=>[r.unchoosenError?((0,t.wg)(),(0,t.iD)("div",P,(0,n.zw)(r.unchoosenError),1)):(0,t.kq)("",!0)])),_:1})]),r.isPending?(0,t.kq)("",!0):((0,t.wg)(),(0,t.iD)("button",Z,"Создать товар")),r.isPending?((0,t.wg)(),(0,t.iD)("button",C,"Создать товар")):(0,t.kq)("",!0)],32)])}l(7658);var U=l(7732),q=l(9944),j=l(402),T=l(1434),V=l(4870),$=l(5282),A={name:"AddProduct",setup(){const{error:e,addDoc:a}=(0,j.Z)("products"),{url:l,filePath:t,uploadImage:i}=(0,T.Z)(),{user:n}=(0,q.Z)(),r=(0,V.iH)(""),s=(0,V.iH)(""),c=(0,V.iH)(""),o=(0,V.iH)(""),u=(0,V.iH)(null),d=(0,V.iH)(null),g=(0,V.iH)(null),p=(0,V.iH)(!1),m=["image/png","image/jpeg"],f=e=>{let a=e.target.files[0];a&&m.includes(a.type)?(u.value=a,console.log(e.target.files[0])):(u.value=null,d.value="Пожалуйста, выберите изображения формата png/jpeg",setTimeout((()=>{d.value=null}),4e3))},v=async()=>{if(u.value){p.value=!0,await i(u.value);await a({title:r.value,description:s.value,category:c.value,price:o.value,imageUrl:l.value,filePath:t.value,userName:n.value.displayName,userUid:n.value.uid,createdAt:(0,U.AB)()});p.value=!1,e.value||$.Z.push({name:"Home"})}else g.value="Пожалуйста, выберите фото",setTimeout((()=>{g.value=null}),3e3)};return{title:r,description:s,category:c,price:o,handleCreate:v,changeImage:f,imageFormatError:d,image:u,isPending:p,unchoosenError:g}}},F=l(89);const M=(0,F.Z)(A,[["render",I],["__scopeId","data-v-04407f22"]]);var N=M}}]);
//# sourceMappingURL=417.8a71b93c.js.map